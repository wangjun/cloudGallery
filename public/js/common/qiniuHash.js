var hash=function(a){this.buffer=a,this.prefix=22,this.blockSize=4194304,this.sha1String=[],this.blockCount=0,this.Buffer=window.ArrayBuffer};hash.prototype.getSha1=function(){var a=this.buffer.byteLength;console.log(a),this.blockCount=Math.ceil(a/this.blockSize);for(var b=0;b<this.blockCount;b++)this.sha1String.push(this.sha1(this.buffer.slice(b*this.blockSize,(b+1)*this.blockSize)));this.calcEtag()},hash.prototype.sha1=function(a){var b=CryptoJS.algo.SHA1.create();b.update(a);var c=b.finalize();return console.log(c),c},hash.prototype.calcEtag=function(){if(!this.sha1String.length)return"Fto5o-5ea0sNMlW_75VgGJCv2AcJ";var a=this.Buffer.concat(this.sha1String,20*this.blockCount);this.blockCount>1&&(this.prefix=150,a=this.sha1(a)),a=this.Buffer.concat([new this.Buffer([this.prefix]),a],a.length+1);var b=a.toString("base64").replace(/\//g,"_").replace(/\+/g,"-");return console.log(b),b};