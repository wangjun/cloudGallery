"use strict";$(document).ready(function(){var a=$("#upload-button"),b=$("#upload-box"),c=$("#upload-input"),d=$("#images"),e=$("#lovely-link"),f=$("#lovely-link-modal"),g=$("#remove-image-button"),h=$("#show-image-modal"),i=$("#gallery-id"),j=i.data("galleryId");!function(){b.on("click",function(a){a.preventDefault(),c.trigger("click")}),a.on("click",function(a){a.preventDefault(),c.trigger("click")}),c.on("change",function(){for(var a=this.files,b=0;b<a.length;b++){var c=a[b],e=new Uploader(c,d);e.upload()}})}(),e.on("click",function(a){a.preventDefault(),f.modal("show")});var k,l,m=h.find(".modal-body");$(document).on("click",".thumbnail",function(a){if(a.preventDefault(),$(this).hasClass("uploading"))window.alertModal("上传中，请稍等~");else{var b=$(this).attr("data-name");k="//cdn.lazycoffee.com/"+$(this).attr("data-key")+"_w868",l=$('<img src="'+k+'" alt="'+b+'" />').hide();var c=$(this).attr("data-key");m.html('<span class="glyphicon glyphicon-refresh spin" aria-hidden="true"></span>'),h.find("[data-key]").attr("data-key",c),h.find(".modal-title").text(b),h.modal("show")}}),h.on("shown.bs.modal",function(){m.html("").prepend(l),h.imagesLoaded(function(){var a=$(window).height();l.css({"max-height":a-150}),l.slideDown()})}),$(document).on("click","[data-action=deleteItem]",function(a){a.preventDefault();var b=$(this).attr("data-key"),c=[2,4,6,7],d=new Uploader;g.html('<span class="glyphicon glyphicon-refresh spin" aria-hidden="true"></span>').prop("disabled",!0),d.removeItem(b,j,function(a){-1===c.indexOf(a.state)?g.html("删除失败").prop("disabled",!0):(g.html("删除成功").prop("disabled",!1),h.modal("hide"),$("[data-key="+b+"]").closest(".image").fadeOut(function(){$(this).remove()}))})}),h.on("hidden.bs.modal",function(){g.text("删除").prop("disabled",!1),m.html('<span class="glyphicon glyphicon-refresh spin" aria-hidden="true"></span>')})});