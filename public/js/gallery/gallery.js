$(document).ready(function(){"use strict";var a=$("#upload-button"),b=$("#upload-input"),c=$("#images"),d=$("#remove-image-button"),e=$("#show-image-modal"),f=$("#gallery-id"),g=f.data("galleryId");a.on("click",function(a){a.preventDefault(),b.trigger("click")}),b.on("change",function(){for(var a=this.files,b=0;b<a.length;b++){var d=a[b],e=new Uploader(d,c);e.upload()}});var h;$(document).on("click",".card",function(a){if(a.preventDefault(),$(this).hasClass("uploading"))window.alertModal("上传中，请耐心等待...");else{var b=$(this).attr("data-name");h="//cdn.lazycoffee.com/"+$(this).attr("data-key")+"_w868";var c=$(this).attr("data-key"),d=$(this).attr("data-hash");e.find("[data-key]").attr("data-key",c),e.find("[data-hash]").attr("data-hash",d),e.find(".header").text(b),e.find("img").attr("src",h),e.imagesLoaded(function(){e.modal("show")})}}),$(document).on("click","[data-action=deleteItem]",function(a){a.preventDefault();var b=$(this).attr("data-key"),c=$(this).attr("data-hash"),f=[2,4,6,7],h=new Uploader;d.addClass("loading").prop("disabled",!0),h.removeItem(b,g,function(a){-1===f.indexOf(a.state)?d.html("删除失败").prop("disabled",!0):(d.html("删除成功").prop("disabled",!1),e.modal("hide"),window.$imagesLayout.masonry("remove",$("#image-"+c)).masonry("layout"))})}),e.onHidden(function(){d.removeClass("loading").prop("disabled",!1)}),window.$imagesLayout=c.masonry({itemSelector:".card",percentPosition:!0}),window.$imagesLayout.imagesLoaded().progress(function(){window.$imagesLayout.masonry("layout")})});