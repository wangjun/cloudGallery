{% extends '../layouts/layout.html' %}
{% block title %}{{ gallery.title }}{% endblock %}
{% block js %}
    <script src="/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/vendor/blueimp-load-image/js/load-image.all.min.js"></script>
    <script src="/js/gallery/image.js"></script>
    <script src="/js/gallery/uploader.js"></script>

    <script src="/js/gallery/gallery.js"></script>
{% endblock %}

{% block css %}
    <link rel="stylesheet" href="/css/gallery/gallery.css"/>
{% endblock %}

{% block body %}
    <div class="container">
        <h1>{{ gallery.title }}</h1>
        <p class="text-muted">{{ gallery.story }}</p>
        <form id="upload-form" action="/gallery/upload">
            <input id="upload-input" multiple type="file" class="hide"/>
        </form>
        <div>
            <div class="btn-group">
                <button id="upload-button" class="btn btn-primary">上传照片</button>
            </div>
            <div class="btn-group" id="share-btn">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">
                    分享相册 <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li><a href="#" id="lovely-link">易记链接</a></li>
                    <li><a href="#">微信朋友圈</a></li>
                    <li><a href="#">新浪微博</a></li>
                    <li><a href="#">微信</a></li>
                </ul>
            </div>
            <div class="btn-group">
                <button type="button" class="btn btn-default">设置相册头像</button>
            </div>
            <div class="btn-group">
                <button type="button" class="btn btn-default">设置相册背景</button>
            </div>
        </div>
        <hr/>
        <div class="row" id="images">
            {% if gallery.images.length %}
                {% for item in gallery.images %}
                    <div class="col-sm-3 image">
                        <a href="" class="thumbnail" data-name="{{ item.fileName }}" data-key="{{ item.key }}" data-hash="{{ item.hash }}" id="{{ item.hash }}">
                            <img src="//cdn.lazycoffee.com/{{ item.key }}_w1024"/>
                        </a>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-center text-muted" id="no-image-gallery">相册内目前没有照片，你可以通过点击左上方蓝色按钮上传图片。</p>
            {% endif %}
        </div>
    </div>
    <div class="hidden" id="gallery-id" data-gallery-id="{{ gallery._id.toHexString() }}"></div>
    <div class="modal fade" id="lovely-link-modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">创建该相册的短链接</h4>
                </div>
                <form class="modal-body">
                    <div class="form-group">
                        <label id="lovely-link-result">将此链接发送给你的朋友:</label>
                        <p class="form-control-static">
                            http://www.lazycoffee.com/gallery/<strong>{% raw %}{{ lovelyLink }}{% endraw %}</strong>
                        </p>
                    </div>
                    <div class="form-group">
                        <label for="lovely-link">易记链接(仅英文):</label>
                        <input name="lovely-link" type="text" ng-model="lovelyLink" class="form-control"
                               placeholder="输入一个易记的英文名称，例如:james-australia-trip"/>
                    </div>
                    <input type="hidden" value="{{ csrfToken }}"/>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary">确定</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="show-image-modal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">image name</h4>
                </div>
                <div class="modal-body">
                    <img src="" alt=""/>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" id="remove-image-button" data-action="deleteItem" data-key="">删除</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}